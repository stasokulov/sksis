"use strict";

//    Находим помеченные блоки. В каждом из них находим внутренний помеченный блок с текстом.
//    Текст обрезаем так, чтобы внутренний блок не растягивался и не выходил за рамки внешнего.
//    Добавляем многоточие в конце.
var containers = document.querySelectorAll('[data-cut_text="container"]'); //const containersArray = [...containers]; // Doesn't work in IE11 and doesn't convert with Babel

var containersArray = Array.prototype.slice.call(containers, 0);
containersArray.forEach(function (container) {
  // Собираем данные о блоке.
  var contHeight = container.offsetHeight;
  var contWidth = container.offsetWidth;
  var blockText = container.querySelector('[data-cut_text="text"]');
  var text = blockText.innerHTML; // Клонируем блок, вставляем клон в родитель исходного блока, чтобы на них действовали одинаковые стили.
  // Скрываем клон, снимаем ограничение на высоту, задаем ширину равную ширине исходного блока.

  var cloneContainer = container.cloneNode(true);
  cloneContainer.style.position = 'absolute';
  cloneContainer.style.visibility = 'hidden';
  cloneContainer.style.height = 'auto';
  cloneContainer.style.width = contWidth + 'px';
  var parentContainer = container.parentElement;
  parentContainer.appendChild(cloneContainer); // Если клон растянулся в высоту, то у текста в клоне итеративно отрезаем символ с конца, добавляем многоточие, вставляем обратно, снова сравниваем.

  var cloneBlockText = cloneContainer.querySelector('[data-cut_text="text"]');
  var cutTextLength = text.length;

  for (; cloneContainer.offsetHeight > contHeight && cutTextLength >= 0; cutTextLength--) {
    cloneBlockText.innerHTML = text.substring(0, cutTextLength) + '...';
  } // Когда высота клона перестала превышать высоту исходного блока, или если символы закончились, вставляем обрезанный текств исходный блок.


  blockText.innerHTML = cloneBlockText.innerHTML; // Удаляем клон.
  // cloneContainer.remove();

  parentContainer.removeChild(cloneContainer); //For IE
}); // При клике на бургер скрываем блоки ниже хедера.

var burger = document.querySelector('.burger');
var main = document.querySelector('main');
var footer = document.querySelector('footer');
burger.addEventListener('click', function () {
  main.classList.toggle('hidden');
  footer.classList.toggle('hidden');
}); // Вставляем дату в помеченные блоки.

var date = new Date();
var year = date.getFullYear();
var dateContainers = document.querySelectorAll('[data-datetime]');
var dateContainersArray = Array.prototype.slice.call(dateContainers); //For IE

dateContainersArray.forEach(function (container) {
  if (container.dataset.datetime === 'year') {
    container.innerHTML = year;
  }
}); // В стопке слайдов по очереди переставляем стиль, дающий видимость слайду.
// Каждый раз перезаписываем содержимое полей баннера данными из базы.
// Когда слайды заканчиваются, начинаем сначала.

var slider = document.querySelector('.slider');
var slides = slider.querySelectorAll('.slide');
var slidesArray = Array.prototype.slice.call(slides); //For IE

var counter = 0;
var banner = document.querySelector('.banner');
var eventDay = banner.querySelector('.banner__event-day');
var eventMonth = banner.querySelector('.banner__event-month');
var eventTitle = banner.querySelector('.banner__event-title');
var eventSubtitle = banner.querySelector('.banner__event-subtitle');
var sliderDataBase = [{
  day: 25,
  month: 'января',
  title: 'день студента',
  subtitle: 'Подздравляем всех учащихся с Днем студента. Желаем творческих и профессиональных успехов.'
}, {
  day: 1,
  month: 'апреля',
  title: 'день дурака',
  subtitle: 'Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aperiam ipsum iusto labore nulla!'
}, {
  day: 31,
  month: 'декабря',
  title: 'Новый год',
  subtitle: 'Изначально Раиса Кудашева опубликовала стихотворение «Ёлка» в детском журнале «Малютка» в 1903 году.'
}];

function showFirstSlide() {
  slidesArray.forEach(function (slide) {
    slide.classList.remove('active');
  });
  counter = 0;
  slidesArray[counter].classList.add('active');
  fillBanner(counter);
}

function turnSlides() {
  if (counter < slidesArray.length - 1) {
    slidesArray[counter].classList.remove('active');
    slidesArray[counter + 1].classList.add('active');
    counter++;
    fillBanner(counter);
  } else {
    showFirstSlide();
  }
}

function fillBanner(counter) {
  var currentSlide = sliderDataBase[counter];
  eventDay.innerHTML = currentSlide.day;
  eventMonth.innerHTML = currentSlide.month;
  eventTitle.innerHTML = currentSlide.title;
  eventSubtitle.innerHTML = currentSlide.subtitle;
}

showFirstSlide();
setInterval(turnSlides, 4000); // Когда целевой блок хедера доскролливается до верха страницы, вынимаем его из потока и фиксируем его относительно экрана.
// Чтобы нижележащие блоки не прыгнули вверх, заменяем вынутый блок пустым блоком той же высоты.

window.addEventListener('scroll', get_sticky_header);

function get_sticky_header() {
  var scrolled = window.pageYOffset || document.documentElement.scrollTop;
  var header = document.querySelector("header");
  var fixed = document.querySelector("header.fixed");
  var emptyHeader = document.querySelector(".empty-header");
  var sticky = document.querySelector(".sticky");
  var headerPaddingTop = 22;
  var mobile = window.innerWidth < 992;

  if (header) {
    if (scrolled > sticky.offsetTop - headerPaddingTop && fixed === null && mobile) {
      var emptyBlock = document.createElement('div');
      emptyBlock.classList.add('empty-header');
      emptyBlock.style.height = header.offsetHeight + 'px';
      header.insertAdjacentElement('beforebegin', emptyBlock);
      header.classList.add('fixed');
    } else if (scrolled <= sticky.offsetTop + headerPaddingTop && fixed !== null) {
      header.classList.remove('fixed'); // emptyHeader.remove();

      emptyHeader.parentElement.removeChild(emptyHeader); //For IE
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL2N1dF90ZXh0LmpzIiwianMvaGVhZGVyLW1lbnUuanMiLCJqcy9pbnNlcnRfZGF0ZS5qcyIsImpzL3NsaWRlci5qcyIsImpzL3N0aWNreS1oZWFkZXIuanMiXSwibmFtZXMiOlsiY29udGFpbmVycyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImNvbnRhaW5lcnNBcnJheSIsIkFycmF5IiwicHJvdG90eXBlIiwic2xpY2UiLCJjYWxsIiwiZm9yRWFjaCIsImNvbnRhaW5lciIsImNvbnRIZWlnaHQiLCJvZmZzZXRIZWlnaHQiLCJjb250V2lkdGgiLCJvZmZzZXRXaWR0aCIsImJsb2NrVGV4dCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0IiwiaW5uZXJIVE1MIiwiY2xvbmVDb250YWluZXIiLCJjbG9uZU5vZGUiLCJzdHlsZSIsInBvc2l0aW9uIiwidmlzaWJpbGl0eSIsImhlaWdodCIsIndpZHRoIiwicGFyZW50Q29udGFpbmVyIiwicGFyZW50RWxlbWVudCIsImFwcGVuZENoaWxkIiwiY2xvbmVCbG9ja1RleHQiLCJjdXRUZXh0TGVuZ3RoIiwibGVuZ3RoIiwic3Vic3RyaW5nIiwicmVtb3ZlQ2hpbGQiLCJidXJnZXIiLCJtYWluIiwiZm9vdGVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImRhdGUiLCJEYXRlIiwieWVhciIsImdldEZ1bGxZZWFyIiwiZGF0ZUNvbnRhaW5lcnMiLCJkYXRlQ29udGFpbmVyc0FycmF5IiwiZGF0YXNldCIsImRhdGV0aW1lIiwic2xpZGVyIiwic2xpZGVzIiwic2xpZGVzQXJyYXkiLCJjb3VudGVyIiwiYmFubmVyIiwiZXZlbnREYXkiLCJldmVudE1vbnRoIiwiZXZlbnRUaXRsZSIsImV2ZW50U3VidGl0bGUiLCJzbGlkZXJEYXRhQmFzZSIsImRheSIsIm1vbnRoIiwidGl0bGUiLCJzdWJ0aXRsZSIsInNob3dGaXJzdFNsaWRlIiwic2xpZGUiLCJyZW1vdmUiLCJhZGQiLCJmaWxsQmFubmVyIiwidHVyblNsaWRlcyIsImN1cnJlbnRTbGlkZSIsInNldEludGVydmFsIiwid2luZG93IiwiZ2V0X3N0aWNreV9oZWFkZXIiLCJzY3JvbGxlZCIsInBhZ2VZT2Zmc2V0IiwiZG9jdW1lbnRFbGVtZW50Iiwic2Nyb2xsVG9wIiwiaGVhZGVyIiwiZml4ZWQiLCJlbXB0eUhlYWRlciIsInN0aWNreSIsImhlYWRlclBhZGRpbmdUb3AiLCJtb2JpbGUiLCJpbm5lcldpZHRoIiwib2Zmc2V0VG9wIiwiZW1wdHlCbG9jayIsImNyZWF0ZUVsZW1lbnQiLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0EsSUFBQUEsVUFBQSxHQUFBQyxRQUFBLENBQUFDLGdCQUFBLENBQUEsNkJBQUEsQ0FBQSxDLENBQ0E7O0FBQ0EsSUFBQUMsZUFBQSxHQUFBQyxLQUFBLENBQUFDLFNBQUEsQ0FBQUMsS0FBQSxDQUFBQyxJQUFBLENBQUFQLFVBQUEsRUFBQSxDQUFBLENBQUE7QUFFQUcsZUFBQSxDQUFBSyxPQUFBLENBQUEsVUFBQUMsU0FBQSxFQUFBO0FBQ0E7QUFDQSxNQUFBQyxVQUFBLEdBQUFELFNBQUEsQ0FBQUUsWUFBQTtBQUNBLE1BQUFDLFNBQUEsR0FBQUgsU0FBQSxDQUFBSSxXQUFBO0FBQ0EsTUFBQUMsU0FBQSxHQUFBTCxTQUFBLENBQUFNLGFBQUEsQ0FBQSx3QkFBQSxDQUFBO0FBQ0EsTUFBQUMsSUFBQSxHQUFBRixTQUFBLENBQUFHLFNBQUEsQ0FMQSxDQU1BO0FBQ0E7O0FBQ0EsTUFBQUMsY0FBQSxHQUFBVCxTQUFBLENBQUFVLFNBQUEsQ0FBQSxJQUFBLENBQUE7QUFDQUQsRUFBQUEsY0FBQSxDQUFBRSxLQUFBLENBQUFDLFFBQUEsR0FBQSxVQUFBO0FBQ0FILEVBQUFBLGNBQUEsQ0FBQUUsS0FBQSxDQUFBRSxVQUFBLEdBQUEsUUFBQTtBQUNBSixFQUFBQSxjQUFBLENBQUFFLEtBQUEsQ0FBQUcsTUFBQSxHQUFBLE1BQUE7QUFDQUwsRUFB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Q0FILEtBQUEsS0FBQSxJQURBLElBRUFJLE1BRkEsRUFFQTtBQUNBLFVBQUFHLFVBQUEsR0FBQWxGLFFBQUEsQ0FBQW1GLGFBQUEsQ0FBQSxLQUFBLENBQUE7QUFDQUQsTUFBQUEsVUFBQSxDQUFBOUMsU0FBQSxDQUFBMkIsR0FBQSxDQUFBLGNBQUE7QUFDQW1CLE1BQUFBLFVBQUEsQ0FBQS9ELEtBQUEsQ0FBQUcsTUFBQSxHQUFBb0QsTUFBQSxDQUFBaEUsWUFBQSxHQUFBLElBQUE7QUFDQWdFLE1BQUFBLE1BQUEsQ0FBQVUscUJBQUEsQ0FBQSxhQUFBLEVBQUFGLFVBQUE7QUFDQVIsTUFBQUEsTUFBQSxDQUFBdEMsU0FBQSxDQUFBMkIsR0FBQSxDQUFBLE9BQUE7QUFDQSxLQVJBLE1BUUEsSUFBQU8sUUFBQSxJQUFBTyxNQUFBLENBQUFJLFNBQUEsR0FBQUgsZ0JBQUEsSUFDQUgsS0FBQSxLQUFBLElBREEsRUFDQTtBQUNBRCxNQUFBQSxNQUFBLENBQUF0QyxTQUFBLENBQUEwQixNQUFBLENBQUEsT0FBQSxFQURBLENBRUE7O0FBQ0FjLE1BQUFBLFdBQUEsQ0FBQW5ELGFBQUEsQ0FBQU0sV0FBQSxDQUFBNkMsV0FBQSxFQUhBLENBR0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoic2NyaXB0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vICAgINCd0LDRhdC+0LTQuNC8INC/0L7QvNC10YfQtdC90L3Ri9C1INCx0LvQvtC60LguINCSINC60LDQttC00L7QvCDQuNC3INC90LjRhSDQvdCw0YXQvtC00LjQvCDQstC90YPRgtGA0LXQvdC90LjQuSDQv9C+0LzQtdGH0LXQvdC90YvQuSDQsdC70L7QuiDRgSDRgtC10LrRgdGC0L7QvC5cclxuLy8gICAg0KLQtdC60YHRgiDQvtCx0YDQtdC30LDQtdC8INGC0LDQuiwg0YfRgtC+0LHRiyDQstC90YPRgtGA0LXQvdC90LjQuSDQsdC70L7QuiDQvdC1INGA0LDRgdGC0Y/Qs9C40LLQsNC70YHRjyDQuCDQvdC1INCy0YvRhdC+0LTQuNC7INC30LAg0YDQsNC80LrQuCDQstC90LXRiNC90LXQs9C+LlxyXG4vLyAgICDQlNC+0LHQsNCy0LvRj9C10Lwg0LzQvdC+0LPQvtGC0L7Rh9C40LUg0LIg0LrQvtC90YbQtS5cclxuY29uc3QgY29udGFpbmVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWN1dF90ZXh0PVwiY29udGFpbmVyXCJdJyk7XHJcbi8vY29uc3QgY29udGFpbmVyc0FycmF5ID0gWy4uLmNvbnRhaW5lcnNdOyAvLyBEb2Vzbid0IHdvcmsgaW4gSUUxMSBhbmQgZG9lc24ndCBjb252ZXJ0IHdpdGggQmFiZWxcclxuY29uc3QgY29udGFpbmVyc0FycmF5ID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoIGNvbnRhaW5lcnMsIDAgKTtcclxuXHJcbmNvbnRhaW5lcnNBcnJheS5mb3JFYWNoKGZ1bmN0aW9uKGNvbnRhaW5lcikge1xyXG4gICAgLy8g0KHQvtCx0LjRgNCw0LXQvCDQtNCw0L3QvdGL0LUg0L4g0LHQu9C+0LrQtS5cclxuICAgIGNvbnN0IGNvbnRIZWlnaHQgPSBjb250YWluZXIub2Zmc2V0SGVpZ2h0O1xyXG4gICAgY29uc3QgY29udFdpZHRoID0gY29udGFpbmVyLm9mZnNldFdpZHRoO1xyXG4gICAgY29uc3QgYmxvY2tUZXh0ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWN1dF90ZXh0PVwidGV4dFwiXScpO1xyXG4gICAgY29uc3QgdGV4dCA9IGJsb2NrVGV4dC5pbm5lckhUTUw7XHJcbiAgICAvLyDQmtC70L7QvdC40YDRg9C10Lwg0LHQu9C+0LosINCy0YHRgtCw0LLQu9GP0LXQvCDQutC70L7QvSDQsiDRgNC+0LTQuNGC0LXQu9GMINC40YHRhdC+0LTQvdC+0LPQviDQsdC70L7QutCwLCDRh9GC0L7QsdGLINC90LAg0L3QuNGFINC00LXQudGB0YLQstC+0LLQsNC70Lgg0L7QtNC40L3QsNC60L7QstGL0LUg0YHRgtC40LvQuC5cclxuICAgIC8vINCh0LrRgNGL0LLQsNC10Lwg0LrQu9C+0L0sINGB0L3QuNC80LDQtdC8INC+0LPRgNCw0L3QuNGH0LXQvdC40LUg0L3QsCDQstGL0YHQvtGC0YMsINC30LDQtNCw0LXQvCDRiNC40YDQuNC90YMg0YDQsNCy0L3Rg9GOINGI0LjRgNC40L3QtSDQuNGB0YXQvtC00L3QvtCz0L4g0LHQu9C+0LrQsC5cclxuICAgIGNvbnN0IGNsb25lQ29udGFpbmVyID0gY29udGFpbmVyLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIGNsb25lQ29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICAgIGNsb25lQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcclxuICAgIGNsb25lQ29udGFpbmVyLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcclxuICAgIGNsb25lQ29udGFpbmVyLnN0eWxlLndpZHRoID0gY29udFdpZHRoICsgJ3B4JztcclxuICAgIGNvbnN0IHBhcmVudENvbnRhaW5lciA9IGNvbnRhaW5lci5wYXJlbnRFbGVtZW50O1xyXG4gICAgcGFyZW50Q29udGFpbmVyLmFwcGVuZENoaWxkKGNsb25lQ29udGFpbmVyKTtcclxuICAgIC8vINCV0YHQu9C4INC60LvQvtC9INGA0LDRgdGC0Y/QvdGD0LvRgdGPINCyINCy0YvRgdC+0YLRgywg0YLQviDRgyDRgtC10LrRgdGC0LAg0LIg0LrQu9C+0L3QtSDQuNGC0LXRgNCw0YLQuNCy0L3QviDQvtGC0YDQtdC30LDQtdC8INGB0LjQvNCy0L7QuyDRgSDQutC+0L3RhtCwLCDQtNC+0LHQsNCy0LvRj9C10Lwg0LzQvdC+0LPQvtGC0L7Rh9C40LUsINCy0YHRgtCw0LLQu9GP0LXQvCDQvtCx0YDQsNGC0L3Qviwg0YHQvdC+0LLQsCDRgdGA0LDQstC90LjQstCw0LXQvC5cclxuICAgIGNvbnN0IGNsb25lQmxvY2tUZXh0ID0gY2xvbmVDb250YWluZXIucXVlcnlTZWxlY3RvcignW2RhdGEtY3V0X3RleHQ9XCJ0ZXh0XCJdJyk7XHJcbiAgICBsZXQgY3V0VGV4dExlbmd0aCA9IHRleHQubGVuZ3RoO1xyXG4gICAgZm9yKDsgY2xvbmVDb250YWluZXIub2Zmc2V0SGVpZ2h0ID4gY29udEhlaWdodCAmJiBjdXRUZXh0TGVuZ3RoID49IDA7IGN1dFRleHRMZW5ndGgtLSkge1xyXG4gICAgICAgIGNsb25lQmxvY2tUZXh0LmlubmVySFRNTCA9IHRleHQuc3Vic3RyaW5nKDAsIGN1dFRleHRMZW5ndGgpICsgJy4uLic7XHJcbiAgICB9XHJcbiAgICAvLyDQmtC+0LPQtNCwINCy0YvRgdC+0YLQsCDQutC70L7QvdCwINC/0LXRgNC10YHRgtCw0LvQsCDQv9GA0LXQstGL0YjQsNGC0Ywg0LLRi9GB0L7RgtGDINC40YHRhdC+0LTQvdC+0LPQviDQsdC70L7QutCwLCDQuNC70Lgg0LXRgdC70Lgg0YHQuNC80LLQvtC70Ysg0LfQsNC60L7QvdGH0LjQu9C40YHRjCwg0LLRgdGC0LDQstC70Y/QtdC8INC+0LHRgNC10LfQsNC90L3Ri9C5INGC0LXQutGB0YLQsiDQuNGB0YXQvtC00L3Ri9C5INCx0LvQvtC6LlxyXG4gICAgYmxvY2tUZXh0LmlubmVySFRNTCA9IGNsb25lQmxvY2tUZXh0LmlubmVySFRNTDtcclxuICAgIC8vINCj0LTQsNC70Y/QtdC8INC60LvQvtC9LlxyXG4gICAgLy8gY2xvbmVDb250YWluZXIucmVtb3ZlKCk7XHJcbiAgICBwYXJlbnRDb250YWluZXIucmVtb3ZlQ2hpbGQoY2xvbmVDb250YWluZXIpOyAvL0ZvciBJRVxyXG59KTtcclxuXHJcbiIsIi8vINCf0YDQuCDQutC70LjQutC1INC90LAg0LHRg9GA0LPQtdGAINGB0LrRgNGL0LLQsNC10Lwg0LHQu9C+0LrQuCDQvdC40LbQtSDRhdC10LTQtdGA0LAuXHJcbmNvbnN0IGJ1cmdlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXJnZXInKTtcclxuY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21haW4nKTtcclxuY29uc3QgZm9vdGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9vdGVyJyk7XHJcbmJ1cmdlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgbWFpbi5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTtcclxuICAgIGZvb3Rlci5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTtcclxufSk7XHJcbiIsIi8vINCS0YHRgtCw0LLQu9GP0LXQvCDQtNCw0YLRgyDQsiDQv9C+0LzQtdGH0LXQvdC90YvQtSDQsdC70L7QutC4LlxyXG5jb25zdCBkYXRlID0gbmV3IERhdGUoKTtcclxuY29uc3QgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcclxuY29uc3QgZGF0ZUNvbnRhaW5lcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1kYXRldGltZV0nKTtcclxuY29uc3QgZGF0ZUNvbnRhaW5lcnNBcnJheSA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRhdGVDb250YWluZXJzKTsgLy9Gb3IgSUVcclxuXHJcbmRhdGVDb250YWluZXJzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihjb250YWluZXIpIHtcclxuICAgIGlmIChjb250YWluZXIuZGF0YXNldC5kYXRldGltZSA9PT0gJ3llYXInKSB7XHJcbiAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9IHllYXI7XHJcbiAgICB9XHJcbn0pO1xyXG4iLCIvLyDQkiDRgdGC0L7Qv9C60LUg0YHQu9Cw0LnQtNC+0LIg0L/QviDQvtGH0LXRgNC10LTQuCDQv9C10YDQtdGB0YLQsNCy0LvRj9C10Lwg0YHRgtC40LvRjCwg0LTQsNGO0YnQuNC5INCy0LjQtNC40LzQvtGB0YLRjCDRgdC70LDQudC00YMuXHJcbi8vINCa0LDQttC00YvQuSDRgNCw0Lcg0L/QtdGA0LXQt9Cw0L/QuNGB0YvQstCw0LXQvCDRgdC+0LTQtdGA0LbQuNC80L7QtSDQv9C+0LvQtdC5INCx0LDQvdC90LXRgNCwINC00LDQvdC90YvQvNC4INC40Lcg0LHQsNC30YsuXHJcbi8vINCa0L7Qs9C00LAg0YHQu9Cw0LnQtNGLINC30LDQutCw0L3Rh9C40LLQsNGO0YLRgdGPLCDQvdCw0YfQuNC90LDQtdC8INGB0L3QsNGH0LDQu9CwLlxyXG5jb25zdCBzbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyJyk7XHJcbmNvbnN0IHNsaWRlcyA9IHNsaWRlci5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGUnKTtcclxuY29uc3Qgc2xpZGVzQXJyYXkgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChzbGlkZXMpOyAvL0ZvciBJRVxyXG5sZXQgY291bnRlciA9IDA7XHJcblxyXG5jb25zdCBiYW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYmFubmVyJyk7XHJcbmNvbnN0IGV2ZW50RGF5ID0gYmFubmVyLnF1ZXJ5U2VsZWN0b3IoJy5iYW5uZXJfX2V2ZW50LWRheScpO1xyXG5jb25zdCBldmVudE1vbnRoID0gYmFubmVyLnF1ZXJ5U2VsZWN0b3IoJy5iYW5uZXJfX2V2ZW50LW1vbnRoJyk7XHJcbmNvbnN0IGV2ZW50VGl0bGUgPSBiYW5uZXIucXVlcnlTZWxlY3RvcignLmJhbm5lcl9fZXZlbnQtdGl0bGUnKTtcclxuY29uc3QgZXZlbnRTdWJ0aXRsZSA9IGJhbm5lci5xdWVyeVNlbGVjdG9yKCcuYmFubmVyX19ldmVudC1zdWJ0aXRsZScpO1xyXG5jb25zdCBzbGlkZXJEYXRhQmFzZSA9IFtcclxuICAgIHtcclxuICAgICAgICBkYXk6IDI1LFxyXG4gICAgICAgIG1vbnRoOiAn0Y/QvdCy0LDRgNGPJyxcclxuICAgICAgICB0aXRsZTogJ9C00LXQvdGMINGB0YLRg9C00LXQvdGC0LAnLFxyXG4gICAgICAgIHN1YnRpdGxlOiAn0J/QvtC00LfQtNGA0LDQstC70Y/QtdC8INCy0YHQtdGFINGD0YfQsNGJ0LjRhdGB0Y8g0YEg0JTQvdC10Lwg0YHRgtGD0LTQtdC90YLQsC4g0JbQtdC70LDQtdC8INGC0LLQvtGA0YfQtdGB0LrQuNGFINC4INC/0YDQvtGE0LXRgdGB0LjQvtC90LDQu9GM0L3Ri9GFINGD0YHQv9C10YXQvtCyLidcclxuICAgIH0sIHtcclxuICAgICAgICBkYXk6IDEsXHJcbiAgICAgICAgbW9udGg6ICfQsNC/0YDQtdC70Y8nLFxyXG4gICAgICAgIHRpdGxlOiAn0LTQtdC90Ywg0LTRg9GA0LDQutCwJyxcclxuICAgICAgICBzdWJ0aXRsZTogJ0xvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNpY2luZyBlbGl0LiBBcGVyaWFtIGlwc3VtIGl1c3RvIGxhYm9yZSBudWxsYSEnXHJcbiAgICB9LCB7XHJcbiAgICAgICAgZGF5OiAzMSxcclxuICAgICAgICBtb250aDogJ9C00LXQutCw0LHRgNGPJyxcclxuICAgICAgICB0aXRsZTogJ9Cd0L7QstGL0Lkg0LPQvtC0JyxcclxuICAgICAgICBzdWJ0aXRsZTogJ9CY0LfQvdCw0YfQsNC70YzQvdC+INCg0LDQuNGB0LAg0JrRg9C00LDRiNC10LLQsCDQvtC/0YPQsdC70LjQutC+0LLQsNC70LAg0YHRgtC40YXQvtGC0LLQvtGA0LXQvdC40LUgwqvQgdC70LrQsMK7INCyINC00LXRgtGB0LrQvtC8INC20YPRgNC90LDQu9C1IMKr0JzQsNC70Y7RgtC60LDCuyDQsiAxOTAzINCz0L7QtNGDLidcclxuICAgIH1cclxuXTtcclxuXHJcbmZ1bmN0aW9uIHNob3dGaXJzdFNsaWRlKCkge1xyXG4gICAgc2xpZGVzQXJyYXkuZm9yRWFjaChmdW5jdGlvbihzbGlkZSkge1xyXG4gICAgICAgIHNsaWRlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgfSk7XHJcbiAgICBjb3VudGVyID0gMDtcclxuICAgIHNsaWRlc0FycmF5W2NvdW50ZXJdLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgZmlsbEJhbm5lcihjb3VudGVyKTtcclxufVxyXG5mdW5jdGlvbiB0dXJuU2xpZGVzKCkge1xyXG4gICAgaWYoY291bnRlciA8IHNsaWRlc0FycmF5Lmxlbmd0aCAtIDEpIHtcclxuICAgICAgICBzbGlkZXNBcnJheVtjb3VudGVyXS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICBzbGlkZXNBcnJheVtjb3VudGVyICsgMV0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICAgICAgY291bnRlcisrO1xyXG4gICAgICAgIGZpbGxCYW5uZXIoY291bnRlcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNob3dGaXJzdFNsaWRlKCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZmlsbEJhbm5lcihjb3VudGVyKSB7XHJcbiAgICBsZXQgY3VycmVudFNsaWRlID0gc2xpZGVyRGF0YUJhc2VbY291bnRlcl07XHJcbiAgICBldmVudERheS5pbm5lckhUTUwgPSBjdXJyZW50U2xpZGUuZGF5O1xyXG4gICAgZXZlbnRNb250aC5pbm5lckhUTUwgPSBjdXJyZW50U2xpZGUubW9udGg7XHJcbiAgICBldmVudFRpdGxlLmlubmVySFRNTCA9IGN1cnJlbnRTbGlkZS50aXRsZTtcclxuICAgIGV2ZW50U3VidGl0bGUuaW5uZXJIVE1MID0gY3VycmVudFNsaWRlLnN1YnRpdGxlO1xyXG59XHJcblxyXG5zaG93Rmlyc3RTbGlkZSgpO1xyXG5zZXRJbnRlcnZhbCh0dXJuU2xpZGVzLDQwMDApO1xyXG4iLCIvLyDQmtC+0LPQtNCwINGG0LXQu9C10LLQvtC5INCx0LvQvtC6INGF0LXQtNC10YDQsCDQtNC+0YHQutGA0L7Qu9C70LjQstCw0LXRgtGB0Y8g0LTQviDQstC10YDRhdCwINGB0YLRgNCw0L3QuNGG0YssINCy0YvQvdC40LzQsNC10Lwg0LXQs9C+INC40Lcg0L/QvtGC0L7QutCwINC4INGE0LjQutGB0LjRgNGD0LXQvCDQtdCz0L4g0L7RgtC90L7RgdC40YLQtdC70YzQvdC+INGN0LrRgNCw0L3QsC5cclxuLy8g0KfRgtC+0LHRiyDQvdC40LbQtdC70LXQttCw0YnQuNC1INCx0LvQvtC60Lgg0L3QtSDQv9GA0YvQs9C90YPQu9C4INCy0LLQtdGA0YUsINC30LDQvNC10L3Rj9C10Lwg0LLRi9C90YPRgtGL0Lkg0LHQu9C+0Log0L/Rg9GB0YLRi9C8INCx0LvQvtC60L7QvCDRgtC+0Lkg0LbQtSDQstGL0YHQvtGC0YsuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBnZXRfc3RpY2t5X2hlYWRlcik7XHJcblxyXG5mdW5jdGlvbiBnZXRfc3RpY2t5X2hlYWRlciAoKSB7XHJcbiAgICBjb25zdCBzY3JvbGxlZCA9IHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xyXG4gICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImhlYWRlclwiKTtcclxuICAgIGNvbnN0IGZpeGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImhlYWRlci5maXhlZFwiKTtcclxuICAgIGNvbnN0IGVtcHR5SGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbXB0eS1oZWFkZXJcIik7XHJcbiAgICBjb25zdCBzdGlja3kgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN0aWNreVwiKTtcclxuICAgIGNvbnN0IGhlYWRlclBhZGRpbmdUb3AgPSAyMjtcclxuICAgIGNvbnN0IG1vYmlsZSA9IHdpbmRvdy5pbm5lcldpZHRoIDwgOTkyO1xyXG4gICAgaWYgKGhlYWRlcikge1xyXG4gICAgICAgIGlmIChzY3JvbGxlZCA+IHN0aWNreS5vZmZzZXRUb3AgLSBoZWFkZXJQYWRkaW5nVG9wICYmXHJcbiAgICAgICAgICAgIGZpeGVkID09PSBudWxsICYmXHJcbiAgICAgICAgICAgIG1vYmlsZSkge1xyXG4gICAgICAgICAgICBjb25zdCBlbXB0eUJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGVtcHR5QmxvY2suY2xhc3NMaXN0LmFkZCgnZW1wdHktaGVhZGVyJyk7XHJcbiAgICAgICAgICAgIGVtcHR5QmxvY2suc3R5bGUuaGVpZ2h0ID0gaGVhZGVyLm9mZnNldEhlaWdodCArICdweCc7XHJcbiAgICAgICAgICAgIGhlYWRlci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2JlZm9yZWJlZ2luJywgZW1wdHlCbG9jayk7XHJcbiAgICAgICAgICAgIGhlYWRlci5jbGFzc0xpc3QuYWRkKCdmaXhlZCcpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoc2Nyb2xsZWQgPD0gc3RpY2t5Lm9mZnNldFRvcCArIGhlYWRlclBhZGRpbmdUb3AgJiZcclxuICAgICAgICAgICAgZml4ZWQgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2ZpeGVkJyk7XHJcbiAgICAgICAgICAgIC8vIGVtcHR5SGVhZGVyLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBlbXB0eUhlYWRlci5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKGVtcHR5SGVhZGVyKTsgLy9Gb3IgSUVcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIl19
